# VulnFixer Configuration - Universal Parser Edition

# ============================================================================
# OLLAMA SETTINGS (Local AI - No API keys needed!)
# ============================================================================
OLLAMA_BASE_URL=http://localhost:11434
OLLAMA_MODEL=codellama:7b
OLLAMA_TIMEOUT=120
USE_OLLAMA=true

# ============================================================================
# UNIVERSAL PARSER SETTINGS (NEW!)
# ============================================================================
ENABLE_UNIVERSAL_PARSING=true
AUTO_DETECT_SCANNER=true
FUZZY_FIELD_MATCHING=true
CSV_DELIMITER_AUTO_DETECT=true

# ============================================================================
# SUPPORTED SCANNERS (NEW!)
# ============================================================================
SUPPORTED_SCANNERS=blackduck,trivy,xray,jfrog,clair,snyk,anchore,generic
SCANNER_DETECTION_CONFIDENCE_THRESHOLD=0.5

# ============================================================================
# VULNERABILITY ENHANCEMENT SETTINGS
# ============================================================================
ENABLE_FIXED_VERSION_RESOLUTION=true
ENHANCEMENT_TIMEOUT=30
ENHANCEMENT_CACHE_SIZE=1000
ENABLE_GITHUB_ADVISORY=true
ENABLE_OSV_API=true
ENABLE_PACKAGE_APIS=true

# ============================================================================
# BITBUCKET CONFIGURATION
# ============================================================================
BITBUCKET_USERNAME=your_username
BITBUCKET_TOKEN=your_app_password

# ============================================================================
# APPLICATION SETTINGS
# ============================================================================
LOG_LEVEL=INFO
ENVIRONMENT=development
MAX_FILE_SIZE=10485760

# ============================================================================
# AI SETTINGS
# ============================================================================
LLM_TEMPERATURE=0.1
MAX_TOKENS=4000

# ============================================================================
# GIT SETTINGS
# ============================================================================
DEFAULT_BRANCH=main
PR_BRANCH_PREFIX=vulnfixer

# ============================================================================
# ENHANCED PARSING SETTINGS (NEW!)
# ============================================================================
HTML_PARSER_ENABLED=true
XML_NAMESPACE_IGNORE=true
JSON_NESTED_PARSING=true

# ============================================================================
# PERFORMANCE SETTINGS (NEW!)
# ============================================================================
PARSER_CACHE_SIZE=1000
PARALLEL_PROCESSING=true
MAX_CONCURRENT_ENHANCEMENTS=5

# ============================================================================
# SCANNER-SPECIFIC SETTINGS (NEW!)
# ============================================================================

# BlackDuck specific settings
BLACKDUCK_SEVERITY_MAPPING_CRITICAL=CRITICAL
BLACKDUCK_SEVERITY_MAPPING_HIGH=HIGH
BLACKDUCK_SEVERITY_MAPPING_MEDIUM=MEDIUM
BLACKDUCK_SEVERITY_MAPPING_LOW=LOW

# Trivy specific settings
TRIVY_SEVERITY_MAPPING_CRITICAL=CRITICAL
TRIVY_SEVERITY_MAPPING_HIGH=HIGH
TRIVY_SEVERITY_MAPPING_MEDIUM=MEDIUM
TRIVY_SEVERITY_MAPPING_LOW=LOW
TRIVY_SEVERITY_MAPPING_UNKNOWN=UNKNOWN

# ============================================================================
# ENHANCEMENT API ENDPOINTS
# ============================================================================
GITHUB_API_BASE=https://api.github.com
OSV_API_BASE=https://api.osv.dev
NPM_REGISTRY_BASE=https://registry.npmjs.org
PYPI_API_BASE=https://pypi.org/pypi
MAVEN_SEARCH_BASE=https://search.maven.org

# ============================================================================
# RATE LIMITING FOR EXTERNAL APIS
# ============================================================================
GITHUB_API_RATE_LIMIT=5000
OSV_API_RATE_LIMIT=1000
PACKAGE_API_RATE_LIMIT=100

# ============================================================================
# OPTIONAL: ALTERNATIVE AI APIS (if not using Ollama)
# ============================================================================
# COPILOT_API_KEY=your_copilot_key
# COPILOT_ENDPOINT=https://api.github.com/copilot
# AZURE_OPENAI_KEY=your_azure_key
# AZURE_OPENAI_ENDPOINT=your_azure_endpoint
# AZURE_OPENAI_MODEL=gpt-4

# ============================================================================
# ADVANCED CONFIGURATION (Optional)
# ============================================================================

# File format support
SUPPORTED_FILE_EXTENSIONS=.csv,.json,.xml,.html,.htm
SUPPORTED_MIME_TYPES=text/csv,application/json,application/xml,text/html

# Parser behavior
STRICT_FIELD_MATCHING=false
CASE_SENSITIVE_HEADERS=false
ALLOW_PARTIAL_MATCHES=true

# Enhancement behavior
SKIP_ENHANCEMENT_ON_ERROR=false
ENHANCEMENT_RETRY_COUNT=3
ENHANCEMENT_BATCH_SIZE=10

# Logging configuration
ENABLE_PARSER_DEBUG_LOGS=false
ENABLE_ENHANCEMENT_DEBUG_LOGS=false
LOG_SCANNER_DETECTION_DETAILS=true

# Security settings
VALIDATE_FILE_CONTENT=true
MAX_VULNERABILITIES_PER_FILE=10000
SANITIZE_INPUT_DATA=true

# ============================================================================
# DEVELOPMENT SETTINGS (for development environment only)
# ============================================================================
# DEV_MODE=true
# MOCK_EXTERNAL_APIS=false
# ENABLE_TEST_ENDPOINTS=true
# BYPASS_BITBUCKET_AUTH=false

# ============================================================================
# PRODUCTION OVERRIDES (uncomment for production)
# ============================================================================
# ENVIRONMENT=production
# LOG_LEVEL=WARNING
# ENHANCEMENT_TIMEOUT=60
# MAX_CONCURRENT_ENHANCEMENTS=3
# ENABLE_PARSER_DEBUG_LOGS=false

# ============================================================================
# MONITORING AND METRICS (Optional)
# ============================================================================
# ENABLE_METRICS=false
# METRICS_PORT=8001
# HEALTH_CHECK_INTERVAL=30

# ============================================================================
# NOTES:
# ============================================================================
# 1. BITBUCKET_USERNAME and BITBUCKET_TOKEN are required for repository operations
# 2. Use Bitbucket App Passwords, not regular passwords
# 3. Ollama must be running locally (ollama serve) 
# 4. Model will be auto-downloaded on first use
# 5. All processing happens locally - no data leaves your machine
# 6. Universal parser auto-detects scanner types - no manual configuration needed
# ============================================================================
